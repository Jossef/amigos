<ion-view view-title="{{vm.event.name}}">

    <ion-nav-bar class="bar-positive" animation="nav-title-slide-ios7">

        <ion-nav-buttons side="left">
            <button class="button button-icon" ui-sref="events"><i class="icon ion-android-arrow-back"></i></button>

        </ion-nav-buttons>
        <ion-nav-buttons side="right">
            <button class="button button-icon" ng-click="vm.popover.show($event)"><i class="icon ion-android-more-vertical"></i></button>
        </ion-nav-buttons>
    </ion-nav-bar>


    <ion-tabs class="tabs-positive tabs-icon-only">

        <ion-tab title="Info" icon="ion-happy-outline">

            <ion-view>
                <ion-content padding="false">


                    <div class="event-image">
                        <img src="http://lorempixel.com/800/380/">

                        <div class="title-wrapper">
                            <h3 class="title">{{vm.event.name}}</h3>

                        </div>
                    </div>


                    <div menu-close class="item item-divider">
                        Date
                    </div>


                    <div class="item item-button-right" ng-repeat="date in vm.event.dates">
                        {{date | date}}
                        <button class="button button-positive">
                            <i class="icon ion-android-calendar"></i>
                        </button>
                    </div>


                    <div menu-close class="item item-divider">
                        Location
                    </div>

                    <div class="item">

                        <h2>
                            <b>{{vm.event.location.address}}</b>
                        </h2>

                        <ui-gmap-google-map options="vm.mapOptions" center="vm.mapCenter" zoom="vm.mapZoom">
                            <ui-gmap-marker coords="vm.mapMarker.location" idkey="0"></ui-gmap-marker>
                        </ui-gmap-google-map>

                        <button ng-click="vm.navigate()"
                                class="button button-block button-positive button-rect"><i class="icon ion-navigate"></i> Take me there!
                        </button>

                    </div>
                </ion-content>
            </ion-view>

        </ion-tab>

        <ion-tab title="Chat" on-select="vm.onChatSelected()" icon="ion-android-chat">

            <ion-content class="pane-chat content-stable" delegate-handle="chatScroll">

                <div class=" pane-chat-body">

                    <div class="message-list">

                        <div ng-repeat="message in vm.event.messages" class="msg msg-group">

                            <div class="message"
                                 ng-init="me = message.user.id == vm.user.id"
                                 ng-class="me ? 'message-out' : 'message-in'">

                                <div class="bubble bubble-text">

                                    <!-- TODO get random color method -->
                                    <div ng-hide="me" class="message-author">⁠⁠⁠
                                        <span class="content"> {{ message.user.name }} </span>
                                    </div>

                                    <div class="message-text">
                                        <span class="message-content" dir="auto">{{ message.message }}</span>
                                    </div>

                                </div>
                                <div class="message-meta">{{ message.timestamp | date:'h:mm a' }}</div>
                            </div>

                        </div>

                    </div>

                </div>
            </ion-content>

            <ion-footer-bar keyboard-attach class="bar-stable item-input-inset">
                <label class="item-input-wrapper">
                    <input type="text" placeholder="Type your message"
                           ng-enter="vm.sendMessage(chatMessage); chatMessage = ''; closeKeyboard()"
                           ng-model="chatMessage"
                           on-focus="inputUp()"
                           on-blur="inputDown()"/>

                </label>
                <button class="button button-clear" ng-click="vm.sendMessage(chatMessage); chatMessage = '';">
                    Send
                </button>
            </ion-footer-bar>

        </ion-tab>

        <ion-tab title="Settings" icon-on="ion-ios-gear" icon-off="ion-ios-gear-outline">

            <ion-view>
                <ion-content padding="false">
                    <div class="list">

                        <ion-toggle ng-model="vm.approved" toggle-class="toggle-positive">Are you going?</ion-toggle>

                        <ion-toggle ng-model="vm.kosher" toggle-class="toggle-positive">Are you eating kosher?</ion-toggle>
                    </div>


                </ion-content>
            </ion-view>
        </ion-tab>

    </ion-tabs>
</ion-view>
